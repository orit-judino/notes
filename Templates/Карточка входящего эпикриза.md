---
больничный: false
ФормаНаправления: Формы направлений
Стационар: Направляющие стационары
Источник: Источники госпитализации
фио: Фамилия Имя Отчество
датаРождения: 2025-12-30
epicris: "[[Матасов.pdf#page=1|Матасов, страница 1]]"
ОД_мкб: "[[Справочники/Заболевания/Основные заболевания/I69.3 Последствия инфаркта головного мозга.md|I69.3 Последствия инфаркта головного мозга]]"
ОД_бассейн: СМА
ОД_парезРука_05: 1
ОД_парезНога_05: 1
ОД_нгз: false
ОД_трахеостома: false
родственник: Отец Иван
ОД_бульбарный_03: 0
ОД_афазия: моторная
ОД_афазия_03: 1
ОД_дизартрия_03: 0
spastika_pwr: 1
result: "I69.3 ЦВБ. Последствия инфаркта головного мозга от 08.01.2026 в левой СМА, тип по TOAST: атеротромботический. Гемипарез: глубокий парез - 1 б. справа, афазия: моторная, умеренная, спастичность: умеренная, нейрогенный мочевой пузырь: умеренные нарушения."
ОД_дата: 2026-01-08
ОД_спастика_03: 1
ОД_сторонаИнсульта: слева
ОД_нейропузырь_03: 1
ОД_фолей: false
ОД_эпицистостома: false
ОД_инсульт_подтип_test: "`INPUT[inlineSelect(option(E10.9 — Сахарный диабет 1 типа без осложнений.), option(E10.0 — Сахарный диабет 1 типа с комой.), option(E10.1 — Сахарный диабет 1 типа с кетоацидозом.), option(E10.2 — Сахарный диабет 1 типа с поражением почек например диабетическая нефропатия .), option(E10.3 — Сахарный диабет 1 типа с поражением глаз например диабетическая ретинопатия .), option(E10.4 — Сахарный диабет 1 типа с неврологическими осложнениями например диабетическая нейропатия .), option(E10.5 — Сахарный диабет 1 типа с поражением периферического кровообращения.), option(E10.6 — Сахарный диабет 1 типа с другими уточненными осложнениями.), option(E10.7 — Сахарный диабет 1 типа с множественными осложнениями.), option(E10.8 — Сахарный диабет 1 типа с неуточненными осложнениями)):ОД_диабет_test]`"
ОД_инсульт_подтип: атеротромботический
ОД_диабет_test: E10.9 — Сахарный диабет 1 типа без осложнений.
---
## Скрипты
```meta-bind-button
label: Создать карточку пациента
icon: ""
style: default
class: ""
cssStyle: ""
backgroundImage: ""
tooltip: ""
id: ""
hidden: false
action:
  type: command
  command: orit-plugin:new-Patient-Card
```
---
## Сведения о запросе
Эпикриз в PDF:`INPUT[text:epicris]`
источник запроса: `INPUT[suggester(optionQuery("Справочники/Источники госпитализации"), useLinks(false), showcase):источник]`
дата запроса:`INPUT[date(showcase):датаЗапроса]`
Стационар: `INPUT[suggester(optionQuery("Справочники/Направляющие стационары"), useLinks(false), showcase):стационар]`
Форма направления: `INPUT[suggester(optionQuery("Справочники/Формы направлений"), useLinks(false), showcase):формаНаправления]`

## Сведения о пациенте и статусе на момент выписки
**ФИО**`INPUT[text(class(wide-mb-text)):фио]`
**Дата рождения:** `INPUT[date:датаРождения]`
наличие больничного листа `INPUT[toggle(showcase):больничный]`
Родственник: (степень родства - Имя - телефон): `INPUT[text(showcase):родственник]`
### Диагноз
#### Основной диагноз 
```meta-bind-js-view
{ОД_мкб} as mkb
{ОД_дата} as oddate
{ОД_сторонаИнсульта} as insult
{ОД_инсульт_подтип} as insult_subtype
{ОД_бассейн} as bassein
{ОД_парезРука_05} as hand
{ОД_парезНога_05} as leg
{ОД_бульбарный_03} as bulbarScore
{ОД_нгз} as bulbarNgz
{ОД_трахеостома} as bulbarTracheo
{ОД_афазия_03} as aphasiaScore
{ОД_афазия} as aphasiaType
{ОД_дизартрия_03} as disartScore
{ОД_спастика_03} as spasticitySeverity
{ОД_нейропузырь_03} as uroScore
{ОД_фолей} as foley
{ОД_эпицистостома} as uroStoma
save to {result}
---
// Формирователь диагноза
const api = app.plugins.plugins['orit-plugin'].api;
const {textFromDVFieldbyLink} = api.oh;
const {tmpRender} = api.utils;
const tmp = textFromDVFieldbyLink(context.bound.mkb,"шаблон")
//console.log(context.bound.side)
const side = context.bound.insult ===  "справа"
	? {insult: "правой", parez: "слева"}
	: {insult: "левой", parez: "справа"}
const subtype = context.bound.insult_subtype;
// проверка на строку
let ins_subtype = "";
if (typeof subtype === "string" && subtype.trim() !== "") {
  // subtype задан
  ins_subtype = `, тип по TOAST:${subtype}`
}
 
// Утилиты
const toIntOrNull = (v) => (Number.isInteger(+v) ? +v : null);

const pushIf = (arr, s) => {
  const x = String(s ?? "").trim();
  if (x) arr.push(x);
};

const limbLevel = (v) =>
  !Number.isFinite(+v) ? null
  : +v === 0 ? "плегия"
  : +v > 3 ? `умеренный парез с силой ${+v} б.`
  : `глубокий парез - ${+v} б.`;

const complications = [];

const hand = limbLevel(context.bound.hand);
const leg  = limbLevel(context.bound.leg);

const parez =
  hand === null || leg === null
    ? ""
    : (hand === "плегия" && leg === "плегия")
      ? "гемиплегия"
      : (hand === leg)
        ? `гемипарез: ${hand}`
        : `гемипарез: в руке — ${hand}, в ноге — ${leg}`;
if(parez) complications.push(`${parez} ${side.parez}`);
// бульбарные нарушения
const bulbarText = (score, hasNgz, hasTracheo) => {
  const s = toIntOrNull(score);
  if (s === null || s === 0) return "";

  const level =
    s === 1 ? "умеренные"
    : s === 2 ? "выраженные"
    : "анартрия";

  const flags = [];
  if (hasNgz === true) flags.push("НГЗ");
  if (hasTracheo === true) flags.push("трахеостома");

  return flags.length
    ? `бульбарные нарушения: ${level} (имеется ${flags.join(", ")})`
    : `бульбарные нарушения: ${level}`;
};
// добавляем блок 
pushIf(complications, bulbarText(
  context.bound.bulbarScore,
  context.bound.bulbarNgz,
  context.bound.bulbarTracheo
));
// Афазия
const aphasiaText = (score, type) => {
  const s = toIntOrNull(score);
  if (s === null || s === 0) return "";

  const lvl =
    s === 1 ? "умеренная"
    : s === 2 ? "глубокая"
    : "тотальная";

  const t = String(type ?? "").trim(); // например: "моторная"
  return t
    ? `афазия: ${t}, ${lvl}`
    : `афазия: ${lvl}`;
};
pushIf(complications, aphasiaText(
  context.bound.aphasiaScore,
  context.bound.aphasiaType
));
// Дизартрия
const dysarthriaText = (severity) => {
  const s = toIntOrNull(severity);
  if (s === null || s === 0) return "";

  const lvl =
    s === 1 ? "умеренная"
    : s === 2 ? "глубокая"
    : "тотальная";

  return `дизартрия: ${lvl}`;
};
pushIf(complications, dysarthriaText(context.bound.disartScore));
// спастичность
const spasticityText = (severity) => {
  const s = toIntOrNull(severity);
  if (s === null || s === 0) return "";

  const lvl =
    s === 1 ? "умеренная"
    : s === 2 ? "глубокая"
    : "контрактура";

  return `спастичность: ${lvl}`;
};
pushIf(complications, spasticityText(context.bound.spasticitySeverity));
// нейрогенные уронарушения
const uroText = (score, hasCat, hasStoma) => {
  const s = toIntOrNull(score);
  if (s === null || s === 0) return "";

  const level =
    s === 1 ? "умеренные нарушения"
    : s === 2 ? "выраженные нарушения"
    : "тотальные нарушения";

  const flags = [];
  if (hasCat === true) flags.push("установлен катетер Фолея");
  if (hasStoma === true) flags.push("носитель эпицистостомы");

  return flags.length
    ? `нейрогенный мочевой пузырь: ${level} (${flags.join(", ")})`
    : `нейрогенный мочевой пузырь: ${level}`;
};
// добавляем блок 
pushIf(complications, uroText(
  context.bound.uroScore,
  context.bound.foley,
  context.bound.uroStoma
));
data = {
	дата: context.bound.oddate,
	сторона: side.insult,
	бассейн: context.bound.bassein,
	подтип: ins_subtype,
	осложнения: complications
}
ds = tmpRender(tmp, data)
//const data = "SSS"
//return engine.markdown.create(`**${context.bound.n1 * context.bound.n2}** km`);
return engine.markdown.create(`${ds}`);
```
##### Основной диагноз в выписке:
`INPUT[textArea(showcase, class(meta-bind-full-width), class(meta-bind-high)):ОД_текст]`
- bild
##### **Неврологический статус на момент выписки:**
`INPUT[textArea(showcase, class(meta-bind-full-width), class(meta-bind-high)):нейростатус_текст]`

##### Характеристика заболевания
Код основного заболевания: `INPUT[suggester(optionQuery("Справочники/Заболевания/Основные заболевания"), useLinks(true)):ОД_мкб]`
**Дата заболевания:** `INPUT[date:ОД_дата]`
- Сторона инсульта: `INPUT[inlineSelect(option(справа), option(слева), showcase):ОД_сторонаИнсульта]`
- Пораженный бассейн: `INPUT[inlineSelect(option(ПМА), option(СМА), option(ЗМА), option(ВБА), option(гемисфере), showcase):ОД_бассейн]`
```meta-bind-js-view
{ОД_мкб} as mkb
save to {ОД_инсульт_подтип}
---
const api = app.plugins.plugins['orit-plugin'].api;
const {textFromFMbyLink} = api.oh;
console.log("mkb", context.bound.mkb)
const subtype = textFromFMbyLink(context.bound.mkb,"подтип");

// Универсально: массив ИЛИ строка "a, b, c"
const toArray = (v) => {
  if (Array.isArray(v)) return v.map(String).map(x => x.trim()).filter(Boolean);
  if (typeof v === "string") {
    const s = v.trim();
    if (!s) return [];
    return s.includes(",")
      ? s.split(",").map(x => x.trim()).filter(Boolean)
      : [s];
  }
  return [];
};
const items = toArray(subtype);
console.log("items", items)
// если для данного диагноза нет доп. сведений — ничего не показываем
if (items.length<2) return null;

// строим inlineSelect
const options = items.map(x => `option(${x})`).join(", ");
const str = `**Подтип инсульта**:\`INPUT[inlineSelect(${options}):ОД_инсульт_подтип]\``;

return engine.markdown.create(str);
```
##### ЗОНА ТЕСТА>
```meta-bind-js-view
{ОД_мкб} as mkb
save to {ОД_инсульт_подтип_test}
---
const api = app.plugins.plugins['orit-plugin'].api;
const md = api.mbui.inlineSelectFromFM({
  link: context.bound.mkb,
  fmKey: "подтип",
  label: "Подтип инсульта",
  saveTo: "ОД_инсульт_подтип",
  readFromFMByLink: api.oh.textFromFMbyLink,
});

return md ? engine.markdown.create(md) : null;
```
---

```meta-bind-js-view
{ОД_мкб} as mkb
save to {ОД_инсульт_подтип_test}
---
const api = app.plugins.plugins["orit-plugin"].api;

const md = api.mbui.inlineSelectFromHeading({
link: "[[Справочники/Заболевания/Сопутствующие/Сахарный диабет/E10 Сахарный диабет инсулинозависимый.md]]",
  heading: "Подрубрики",
  label: "Test",
  saveTo: "ОД_диабет_test",
  readListUnderHeadingByLink: api.oh.listUnderHeadingByLink,
  originPath: context.file.path,
});

return md ? engine.markdown.create(md) : null;
```


##### ЗОНА ТЕСТА<
- Глубина пареза
	- в руках: `INPUT[slider(addLabels, minValue(0), maxValue(5), stepSize(1), showcase):ОД_парезРука_05]`
    - в ногах: `INPUT[slider(addLabels, minValue(0), maxValue(5), stepSize(1), showcase):ОД_парезНога_05]`
- Бульбарные нарушения: по шкале 0-нет 1-умеренные 2-НГЗ 3-анартрия `INPUT[slider(addLabels, minValue(0), maxValue(3), stepSize(1), showcase):ОД_бульбарный_03]`
    - в документах наличие:
        - НГЗ: `INPUT[toggle(showcase):ОД_нгз]`
        - трахеостома: `INPUT[toggle(showcase):ОД_трахеостома]`
- Афазия:
	- наличие: `INPUT[inlineSelect(option(моторная), option(сенсорная), option(сенсомоторная), showcase):ОД_афазия]`
    - выраженность по шкале 0-нет 1-умеренная 2-глубокая 3-тотальная `INPUT[slider(addLabels, minValue(0), maxValue(3), stepSize(1), showcase):ОД_афазия_03]`
- Дизартрия
     - выраженность по шкале 0-нет 1-умеренная 2-глубокая 3-тотальная `INPUT[slider(addLabels, minValue(0), maxValue(3), stepSize(1), showcase):ОД_дизартрия_03]`
- Спастика
    - выраженность по шкале 0-нет 1-умеренная 2-глубокая 3-контрактура `INPUT[slider(addLabels, minValue(0), maxValue(3), stepSize(1), showcase):ОД_спастика_03]`
- Нейрогенный мочевой пузырь: по шкале 0-нет 1-умеренные 2-катетер 3-стома `INPUT[slider(addLabels, minValue(0), maxValue(3), stepSize(1), showcase):ОД_нейропузырь_03]`
    - в документах наличие:
        - катетер Фолея: `INPUT[toggle(showcase):ОД_фолей]`
        - эпицистостома: `INPUT[toggle(showcase):ОД_эпицистостома]`
#### Сопутствующий диагноз 
здесь будет формирующий скрипт
##### Сопутствующий диагноз  из выписки:
`INPUT[textArea(showcase, class(meta-bind-full-width), class(meta-bind-high)):concomds_epicris]`
- bild
##### Типичная фоновая патология 
- Атеросклероз
	- [ ] [[I67.2 Церебральный атеросклероз]]
	- [ ] [[I25.2 Постинфарктный кардиосклероз]]
	- [ ] [[I70.9 Генерализованный атеросклероз]]
- Сердечно-сосудистая патология
	- [ ] Гипертоническая болезнь
	- [ ] Хроническая сердечная недостаточность
	- [ ] Нарушение ритма
	- [ ] Нарушения проводимости
- Эндокринная патология
	- [ ] Сахарный диабет
##### Типичная сопутствующая патология
- Заболевания легких
	- ХОБЛ
	- Бронхиальная астма
- Эндокринная патология
	- Заболевания щитовидной железы

###### Прочие выявленные проблемы
1. Тромбоз глубоких вен  `INPUT[toggle(showcase):НГЗ]`
2. Психические нарушения `INPUT[toggle(showcase):НГЗ]`
3. Нарушение стула `INPUT[toggle(showcase):НГЗ]`

## Выполненные исследования
